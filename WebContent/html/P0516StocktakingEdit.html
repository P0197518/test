<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>盘点实际录入</title>
    <script src="../boot.js" type="text/javascript"></script>
</head>

<body class="no-skin">
    <div class="edit-page-content">
        <div id="form1" class="form-horizontal">
            <input name="type" id="type" class="mini-hidden" value="" />
            <input class="mini-hidden" name="mode" id="mode" />
            <div>
                <div class="tab-content profile-edit-tab-content">
                    <div id="edit-basic" class="tab-pane in active">
                        <h4 class="header blue bolder smaller">盘点基本信息</h4>
                        <div>
                            <div class="form-group">
                                <label for="name" class="control-label col-sm-0">盘点单号:</label>
                                <div class="col-sm-3">
                                    <input id="inventoryNo" class="mini-textbox" textField="text" required="ture" valueField="value" />
                                </div>
                                <label for="name" class="control-label col-sm-0">盘点名称:</label>
                                <div class="col-sm-3">
                                    <input id="inventoryName" class="mini-textbox" textField="text" required="ture" valueField="value" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="name" class="control-label col-sm-0">大分类:</label>
                                <div class="col-sm-3">
                                    <input id="bigClassify" class="mini-combobox" textField="text" valueField="value" data='[{value:"0001",text:"钢柄"},{value:"0002",text:"合金"}]' />
                                </div>
                                <label for="name" class="control-label col-sm-0">小分类:</label>
                                <div class="col-sm-3">
                                    <input id="smallClassify" class="mini-combobox" textField="text" valueField="value" data='[{value:"0001",text:"A钢柄"},{value:"0002",text:"B钢柄"},{value:"0003",text:"C钢柄"}]' />
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="name" class="control-label col-sm-0">负责人:</label>
                                <div class="col-sm-3">
                                    <input id="inventoryUser" enabled="false" class="mini-textbox" textField="text" required="ture" valueField="value" />
                                </div>


                                <label for="name" class="control-label col-sm-0">盘点日期:</label>
                                <div class="col-sm-3">
                                    <input id="inventoryDate" allowInput="false " class="mini-datepicker" format="yyyy/MM/dd" showOkButton="true " required="ture" />
                                </div>

                            </div>
                            <div class="form-group">
                                <label for="name" class="control-label col-sm-0">备注:</label>
                                <div class="col-sm-3">
                                    <input id="remark" class="mini-textbox" style="width:510px;" textField="text" valueField="value" />
                                </div>
                            </div>
                        </div>
                        <h4 class="header blue bolder smaller">产品列表</h4>
                        <div class="vspace-12-sm"></div>
                        <div class="space-4"></div>
                        <div class="mini-toolbar">
                            <table style="width:100%;">
                                <tr>
                                    <td style="width:100%;">
                                        <a class="mini-button" iconCls="icon-add" onclick="addRow()" plain="true">新增</a>
                                        <span class="separator"></span>
                                        <a class="mini-button" iconCls="icon-remove" onclick="removeRow()" plain="true">删除</a>
                                        <span class="separator"></span>
                                        <a class="mini-button" iconCls="icon-upload" onclick="importData()" plain="true">导入</a>
                                    </td>
                                </tr>
                            </table>
                            <div class="">
                            </div>
                            <div id="grid1" class="mini-datagrid" allowCellEdit="true" skipReadOnlyCell="true" idField="id" allowResize="false" allowCellSelect="true" multiSelect="false" editNextOnEnterKey="true" sortOrder="asc" showPager="false">
                                <div property="columns">
                                    <div type="checkcolumn"></div>
                                    <div field="smallClassify" width="80" headerAlign="center" sortField="zhiZaoFanHao" align="center">小分类</div>
                                    <div field="materialName" width="100" headerAlign="center" sortField="zhiZaoFanHao" align="center">原料品名</div>
                                    <div field="texture" width="80" headerAlign="center" sortField="productnum" allowSort="false" align="center">原料材质</div>
                                    <div field="drawingNo" width="80" headerAlign="center" sortField="productnum" allowSort="false" align="center">原料图纸编号</div>
                                    <div field="relateNo" width="80" headerAlign="center" sortField="productnum" allowSort="false" align="center">关联单号</div>
                                    <div field="price" width="60" headerAlign="center" sortField="money" allowSort="false" align="right" datatype="currency">单价</div>
                                    <div field="stockCount" width="60" headerAlign="center" sortField="money" allowSort="false" align="right" datatype="currency">理论数量</div>
                                    <div field="realCount" width="80" headerAlign="center" sortField="money" allowSort="false" align="right" datatype="currency">实际数量<i class="ace-icon fa fa-pencil-square-o"></i>
                                        <input property="editor" class="mini-textbox" style="width:100%;" />
                                    </div>
                                    <div field="diffCount" width="80" headerAlign="center" sortField="money" allowSort="false" align="right" datatype="currency">差异数</div>
                                    <div field="remark" width="160" headerAlign="center" sortField="money" allowSort="false" align="left">备注<i class="ace-icon fa fa-pencil-square-o"></i>
                                        <input property="editor" class="mini-textbox" style="width:100%;" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div style="text-align:center;padding:10px;">
                <a class="mini-button btn btn-success btn-round" onclick="saveDraft()" type="button">
                    <i class="ace-icon fa fa-floppy-o bigger-110"></i> 创建盘点计划
                </a> &nbsp; &nbsp;
                <a class="mini-button btn btn-success btn-round" onclick="saveDraft()" type="button">
                    <i class="ace-icon fa fa-floppy-o bigger-110"></i> 保存盘点结果
                </a> &nbsp; &nbsp;
            </div>
        </div>
    </div>
    <script text="text/javascript">
        mini.parse();
        var grid = mini.get("grid1");
        var gridData = new Array();

        for (var i = 0; i < 20; i++) {
            gridData.push({
                smallClassify: "環境（超硬）",
                materialName: "C-50KIRS(インナービット)",
                drawingNo: "E-3650",
                productNo: "E-3650-TE60",
                texture: "TE60",
                relateNo: "QH-J19001",
                price: 150,
                stockCount: 100,
                realCount: 120,
                diffCount: 20,
                remark: '',
            });
        }

        grid.setData(gridData);

        function addRow() {
            var newRow = {
                name: "New Row"
            };
            grid.addRow(newRow, grid.getData().length);
            grid.beginEditCell(newRow, "LoginName");
        }

        grid.on("drawcell", function(e) {
            if (e.column.field == "diffCount") {
                if (e.record.diffCount > 0) {
                    e.cellHtml = '<span style="color:green;">' + e.record.diffCount + '</span>';
                } else if (e.record.diffCount < 0) {
                    e.cellHtml = '<span style="color:red;">' + e.record.diffCount + '</span>';
                } else {
                    e.cellHtml = '<span >' + e.record.diffCount + '</span>';
                }

            }
        });

        function removeRow() {
            var rows = grid.getSelecteds();
            if (rows.length > 0) {

                grid.removeRows(rows, true);
            } else {
                mini.alert("没有可删除的数据")
            }
        }
    </script>
</body>

</html>