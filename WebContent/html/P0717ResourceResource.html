<!DOCTYPE html>
<html>

<head>
    <title>父资源选择</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="../boot.js" type="text/javascript"></script>
    <script src="../ace/aceui/locale/ja_JP.js" type="text/javascript"></script>
</head>

<body class="no-skin">


    <div class="mini-fit">
        <ul id="tree1" class="mini-tree" style="width:100%;height:100%;" showTreeIcon="true" textField="resourcename" idField="UID" parentField="ParentTaskUID" resultAsTree="false" expandOnLoad="true" onnodedblclick="onNodeDblClick" expandOnDblClick="false">
        </ul>
    </div>
    <div class="mini-toolbar" style="text-align:center;padding-top:8px;padding-bottom:8px;" borderStyle="border-left:0;border-bottom:0;border-right:0;">
        <a class="mini-button" style="width:60px;" onclick="onOk()">确 定</a>
        <span style="display:inline-block;width:25px;"></span>
        <a class="mini-button" style="width:60px;" onclick="onCancel()">取 消</a>
    </div>

    <script type="text/javascript">
        mini.parse();

        var tree = mini.get("tree1");

        var treeData = new Array();

        treeData.push({

            "UID": "1",
            "resourcename": "在库管理",
            "resourceurl": "../asdads/",
            "imgvalue": "2007-01-01T00:00:00",
            "moduleid": "在库管理",
            "sortorder": "1",
            "PredecessorLink": [],
            "ParentTaskUID": "-1",
        }, {
            "UID": "2",
            "resourcename": "在库查询",
            "resourceurl": "../asdads/",
            "imgvalue": "",
            "moduleid": "E01002",
            "sortorder": "01",
            "PredecessorLink": [],
            "ParentTaskUID": "1",
        }, {
            "UID": "3",
            "resourcename": "在库估算查询",
            "resourceurl": "../asdads/",
            "imgvalue": "",
            "moduleid": "E01003",
            "sortorder": "02",
            "PredecessorLink": [],
            "ParentTaskUID": "1",
        }, {
            "UID": "4",
            "resourcename": "产品入库",
            "resourceurl": "../asdads/",
            "imgvalue": "",
            "moduleid": "E01004",
            "sortorder": "03",
            "PredecessorLink": [],
            "ParentTaskUID": "1",
        }, {
            "UID": "5",
            "resourcename": "支付款管理",
            "resourceurl": "../asdads/",
            "imgvalue": "",
            "moduleid": "支付款管理",
            "sortorder": "1",
            "PredecessorLink": [],
            "ParentTaskUID": "",
        }, {
            "UID": "6",
            "resourcename": "订货支付申请",
            "resourceurl": "../asdads/",
            "imgvalue": "",
            "moduleid": "C01001",
            "sortorder": "01",
            "PredecessorLink": [],
            "ParentTaskUID": "5",
        }, {
            "UID": "7",
            "resourcename": "订货支付申请确认",
            "resourceurl": "../asdads/",
            "imgvalue": "",
            "moduleid": "C01001",
            "sortorder": "02",
            "PredecessorLink": [],
            "ParentTaskUID": "5",
        })

        tree.loadList(treeData, "UID", "ParentTaskUID")

        function setAllowSelect(checked) {
            var tree = mini.get("tree1");
            tree.setAllowSelect(checked);
        }

        function setShowCheckBox(checked) {
            var tree = mini.get("tree1");
            tree.setShowCheckBox(checked);

            var d = document.getElementById("ShowFolderCheckBox_div");
            d.style.display = checked ? "block" : "none";

            var d = document.getElementById("CheckRecursive_div");
            d.style.display = checked ? "block" : "none";
        }

        function setShowFolderCheckBox(checked) {
            var tree = mini.get("tree1");
            tree.setShowFolderCheckBox(checked);
        }

        function setShowExpandButtons(checked) {
            var tree = mini.get("tree1");
            tree.setShowExpandButtons(checked);
        }

        function setShowTreeIcon(checked) {
            var tree = mini.get("tree1");
            tree.setShowTreeIcon(checked);
        }

        function setShowTreeLines(checked) {
            var tree = mini.get("tree1");
            tree.setShowTreeLines(checked);
        }

        function setAllowSelect(checked) {
            var tree = mini.get("tree1");
            tree.setAllowSelect(checked);
        }

        function setEnableHotTrack(checked) {
            var tree = mini.get("tree1");
            tree.setEnableHotTrack(checked);
        }

        function setCheckRecursive(checked) {
            var tree = mini.get("tree1");
            tree.setCheckRecursive(checked);
        }

        function getSelectedNode() {
            var tree = mini.get("tree1");
            var node = tree.getSelectedNode();
            if (node) {
                alert(node.text);
            } else {
                alert("请选中节点");
            }
        }

        function getCheckedNodes() {
            var tree = mini.get("tree1");
            var nodes = tree.getCheckedNodes();
            alert("Checked Nodes : " + nodes.length);
        }

        function onSelectNode(e) {
            var tree = e.sender;
            var node = tree.getSelectedNode();
            document.getElementById("nodeText").innerHTML = node.text;
        }

        function findNodes() {
            var tree = mini.get("tree1");
            var nodes = tree.findNodes(function(node) {
                if (node.id == "button") return true;
            });
            alert("find: " + nodes[0].text);
        }

        function GetSize() {
            var node = tree.getSelectedNode();
            return tree.getAncestors(node).length;
        }

        function search() {
            var key = mini.get("key").getValue();
            if (key == "") {
                tree.clearFilter();
            } else {
                key = key.toLowerCase();
                tree.filter(function(node) {
                    var text = node.text ? node.text.toLowerCase() : "";
                    if (text.indexOf(key) != -1) {
                        return true;
                    }
                });
            }
        }

        function onKeyEnter(e) {
            search();
        }


        function onNodeDblClick(e) {
            onOk();
        }
        //////////////////////////////////
        function CloseWindow(action) {
            if (window.CloseOwnerWindow) return window.CloseOwnerWindow(action);
            else window.close();
        }

        function onOk() {
            var node = tree.getSelectedNode();
            /* if (node && tree.isLeaf(node) == false) {
            	alert("不能选中父节点");
            	return;
            } */

            CloseWindow("ok");
        }

        function onClear() {
            tree.uncheckAllNodes();
            CloseWindow("clear");
        }

        function onCancel() {
            CloseWindow("cancel");
        }

        function GetData() {
            var node = tree.getSelectedNode();
            return node;
        }
    </script>


</body>

</html>