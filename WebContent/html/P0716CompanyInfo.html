<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>公司基本信息管理</title>
    <script src="../boot.js" type="text/javascript"></script>
</head>

<body class="no-skin">

    <div class="mini-toolbar" style="/* border-bottom:0; */padding:0px;border-top:0;margin-top:5px;margin-bottom:5px;">
        <table style="width:100%;">
            <tr>
                <td style="width:100%;">
                    <a class="mini-button btn btn-success btn-round" onclick="edit()">
                        <i class="ace-icon fa fa-pencil-square-o"></i>编辑
                    </a>
                </td>
            </tr>
        </table>
    </div>

    <div class="mini-fit">
        <div id="grid" class="mini-datagrid" style="width:100%;height:100%;" " idField="id" resultAsTree="false" allowResize="false" allowAlternating="true" showPager="false">
            <div property="columns">
                <div type="checkcolumn">选择</div>
                <div field="companyname" name="companyname" width="160" headerAlign="center">公司名</div>
                <div field="shortname" name="shortname" width="95" headerAlign="center">公司名简称</div>
                <div field="companynameen" name="companynameen" width="160" headerAlign="center">公司名(英语)</div>
                <div field="address" name="address" width="255" headerAlign="center">地址</div>
                <div field="postalcode" name="postalcode" width="100" headerAlign="center" align="center">邮编</div>
                <div field="mail" name="mail" width="160" headerAlign="center">Mail</div>
                <div field="tel" name="phone" width="120" headerAlign="center" align="center">联系电话</div>
                <div field="fax" name="fax" width="120" headerAlign="center" align="center">FAX</div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        mini.parse();

        var grid = mini.get("grid");

        //grid.load();
        var gridData = new Array();
        gridData.push({
            "companyname": "青岛光谷机械有限公司",
            "shortname": "光谷机械",
            "companynameen": "QDGG Co.,Ltd",
            "postalcode": "056201",
            "address": "山东省胶州市通岭路西322号",
            "tel": "0532-54015678",
            "fax": "0532-54015678",
            "mail": "guanggu@163.com",
            "bank": "中国银行青岛市浮山所支行",
            "accounttype": "活期存款",
            "account": "7878778",
            "accountname": "张三",
            "sealimg": "",
        }, {
            "companyname": "光谷总社（日本）",
            "shortname": "光谷机械",
            "companynameen": "JPGG Co.,Ltd",
            "postalcode": "812-5432",
            "address": "福冈县福冈市博多区福冈国际机场北",
            "tel": "092-710-1234",
            "fax": "092-710-1234",
            "mail": "guanggu@hokai.co.jp",
            "bank": "三井住友银行福冈分行（701）",
            "accounttype": "活期存款",
            "account": "8989889",
            "accountname": "森健太郎",
            "sealimg": "",
        });
        grid.setData(gridData);

        // 编辑操作
        /*function edit() {
            var rows = grid.getSelecteds();
            if (rows.length == 1) {
                var row = grid.getSelected();

                var popupParam = openCommonPopupParam(
                        "/S9905CompanyInfo/indexEdit?id=" + row.id, "编辑会社");
                popupParam.ondestroy = function(action) {
                    if (action == "ok") {
                        grid.reload();
                    }
                };
                mini.open(popupParam);
            } else {
                mini.alert(businessMessage.get("E0006"));
            }
        }*/

        function edit() {
            var rows = grid.getSelecteds();
            if (rows.length == 1) {
                var row = grid.getSelected();
                mini.open({
                    url: "P0716CompanyInfoEdit.html",
                    title: "公司基本信息编辑",
                    width: 1100,
                    height: 600,
                    onload: function() {
                        var iframe = this.getIFrameEl();
                        var data = {
                            companyname: row.companyname,
                            shortname: row.shortname,
                            companynameen: row.companynameen,
                            postalcode: row.postalcode,
                            address: row.address,
                            tel: row.tel,
                            fax: row.fax,
                            mail: row.mail,
                            bank: row.bank,
                            account: row.account,
                            accounttype: row.accounttype,
                            accountname: row.accountname,
                            sealimg: row.sealimg
                        };
                        iframe.contentWindow.SetData(data);
                    },
                    ondestroy: function(action) {
                        //grid.reload();
                    }
                });
            } else {
                mini.alert("请选择...");
            }
        }

        function saveData(data) {
            var newRow = {
                companyname: data.companyname,
                shortname: data.shortname,
                companynameen: data.companynameen,
                postalcode: data.postalcode,
                address: data.address,
                tel: data.tel,
                fax: data.fax,
                mail: data.mail,
                bank: data.bank,
                account: data.account,
                accounttype: data.accounttype,
                accountname: data.accountname,
                sealimg: data.sealimg
            };

            grid.updateRow(grid.getSelected(), newRow);
        }
    </script>

</body>

</html>