<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>不良返品登记</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="../boot.js" type="text/javascript"></script>
</head>

<body onload="">

    <div class="edit-page-content">
        <div id="form1" class="form-horizontal" style="width:100%;min-width:800px;">
            <div>
                <div class="tab-content profile-edit-tab-content">
                    <div id="edit-basic" class="tab-pane in active">
                        <h4 class="header blue bolder smaller">基本信息</h4>

                        <div class="vspace-12-sm"></div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">退货类型:</label>
                            <div class="col-sm-3">
                                <div id="backType" class="mini-radiobuttonlist" onvaluechanged="backTypeChange" value="0001" repeatLayout="table" repeatDirection="vertical" textField="text" valueField="value" value="cn" data='[{value:"0001",text:"订单返货"},{value:"0002",text:"采购退货"},{value:"0002",text:"委外退货"}]'>
                                </div>
                            </div>
                        </div>

                        <div class="form-group" id="customArea">
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">客户:</label>
                            <div class="col-sm-4">

                                <input id="customNo" class="mini-textbox" style="width:50px;" vtype="half:40" maxlength=40 required="true" />
                                <a class="mini-button btn btn-info btn-round" type="button" onclick="customChoose()" onenter="onOk()" />
                                <i class="ace-icon fa fa-search"> </i>
                                </a>
                                <input name="customName" id="customName" class="mini-textbox" value="" enabled="false" vtype="maxLength:30" required="true" requiredErrorText="不能为空" onenter="onOk()" />
                            </div>
                        </div>
                        <div class="form-group" style="display: none;" id="supplierArea">
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">供应商:</label>
                            <div class="col-sm-4">

                                <input id="customNo" class="mini-textbox" style="width:50px;" vtype="half:40" maxlength=40 required="true" />
                                <a class="mini-button btn btn-info btn-round" type="button" onclick="customChoose()" onenter="onOk()" />
                                <i class="ace-icon fa fa-search"> </i>
                                </a>
                                <input name="customName" id="customName" class="mini-textbox" value="" enabled="false" vtype="maxLength:30" required="true" requiredErrorText="不能为空" onenter="onOk()" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">不良类型:</label>
                            <div class="col-sm-3">
                                <input id="ebsandcafflag" name="ebsandcafflag" class="mini-combobox" required="true" valueField="value" textField="text" emptyText="" data='[{value:"0001",text:"不良(可修理)"},{value:"0002",text:"不良(不可修理)"}]' />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">关联单号:</label>
                            <div class="col-sm-3">
                                <input name="orderNo" id="orderNo" class="mini-textbox" value="" vtype="maxLength:30" required="true" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">操作人:</label>
                            <div class="col-sm-3">
                                <input name="director" id="director" class="mini-textbox" value="Admin" enabled="false" vtype="maxLength:30" required="true" />
                            </div>
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">操作日期:</label>
                            <div class="col-sm-3">
                                <input name="date" id="date" class="mini-datepicker" required="true" format="yyyy/MM/dd" />
                            </div>
                        </div>

                        <div class="space-2"></div>
                        <div class="form-group">

                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label no-padding-right" for="form-field-username">备注:</label>
                            <div class="col-sm-3">
                                <textarea id="remark" name="remark" class="mini-textarea" style="width:442px;"></textarea>
                            </div>
                        </div>

                        <div class="space-4"></div>
                        <h4 class="header blue bolder smaller">产品信息</h4>
                        <div class="vspace-12-sm"></div>

                        <div class="mini-toolbar">
                            <table style="width:100%;">
                                <tr>
                                    <td style="width:100%;">
                                        <a class="mini-button" iconCls="icon-add" onclick="addRow()" plain="true">新增</a>
                                        <span class="separator"></span>
                                        <a class="mini-button" iconCls="icon-remove" onclick="removeRow()" plain="true">删除</a>

                                    </td>
                                </tr>
                            </table>
                        </div>

                        <div id="grid" class="mini-datagrid" style="height:130px;" showPager="false" idField="id" allowResize="false" allowCellEdit="true" allowCellSelect="true" multiSelect="false" editNextOnEnterKey="true" style="width:100%;height:100%;" oncellcommitedit="OnCellCommitEdit">
                            <div property="columns">
                                <div type="checkcolumn"></div>

                                <div field="drawingNo" width="80" headerAlign="center" sortField="jan" allowSort="false" align="center">
                                    图纸编号&nbsp;<i class="ace-icon fa fa-pencil-square-o"></i>
                                    <input property="editor" class="mini-textbox" style="width:100%;" />
                                </div>
                                <div field="productNo" width="100" headerAlign="center" sortField="jan" allowSort="false" align="center">
                                    品番&nbsp;<i class="ace-icon fa fa-pencil-square-o"></i>
                                    <input property="editor" class="mini-textbox" style="width:100%;" />
                                </div>
                                <div field="materialName" width="120" headerAlign="center" sortField="money" allowSort="false" align="left">品名</div>
                                <div field="texture" width="80" headerAlign="center" sortField="money" allowSort="false" align="left">材质</div>
                                <div field="fanpinshu" width="100" headerAlign="center" align="right" allowSort="false">
                                    退货数&nbsp;<i class="ace-icon fa fa-pencil-square-o"></i>
                                    <input property="editor" class="mini-textbox" style="width:100%;" minWidth="100%" />
                                </div>
                                <div field="reason" displayField="hejinname" width="120" headerAlign="center" allowSort="false">
                                    问题原因&nbsp;<i class="ace-icon fa fa-pencil-square-o"></i>
                                    <input property="editor" class="mini-combobox" multiSelect="true" style="width:100%;" data="reasonData" />
                                </div>

                                <div field="jutibuliang" width="250" headerAlign="center" allowSort="false">
                                    具体不良内容&nbsp;<i class="ace-icon fa fa-pencil-square-o"></i>
                                    <input property="editor" class="mini-textarea" style="width:200px;" minWidth="200" minHeight="50" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align:center;padding:10px;">
                <a class="mini-button btn btn-info btn-round " onclick="onSave()" type="button">
                    <i class="ace-icon fa fa-floppy-o bigger-110"></i> 保存
                </a> &nbsp; &nbsp;
                <a class="mini-button btn btn-warning btn-round" onclick="onCancel()" type="button">
                    <i class="ace-icon fa fa-undo bigger-110"></i> 取消
                </a>
            </div>
        </div>
        <!-- /.page-content -->

        <script type="text/javascript">
            var form = new mini.Form("#form1");
            mini.parse();

            mini.get("date").setValue(new Date());

            var grid = mini.get("grid");


            function addRow() {
                var newRow = {};
                grid.addRow(newRow, grid.getData().length);
            }

            function removeRow() {
                var rows = grid.getSelecteds();
                if (rows.length > 0) {
                    grid.removeRows(rows, true);
                }
            }
            var reasonData = [{
                id: 1,
                text: '合金来料问题'
            }, {
                id: 2,
                text: '钢柄来料问题'
            }, {
                id: 3,
                text: '银焊问题'
            }, {
                id: 4,
                text: '打磨问题'
            }, {
                id: 5,
                text: '研磨问题'
            }, {
                id: 6,
                text: '外协提供成品问题'
            }, {
                id: 7,
                text: '其他'
            }];

            function OnCellCommitEdit(e) {
                var grid = e.sender;
                var record = e.record;
                var field = e.field;
                var value = e.value;

                if (field == "danhao") {
                    var data;
                    data = {
                        danhao: value,
                        ji: "计",
                        tuhao: "E-2830",
                        caizhi: "SCM440"
                    }
                    grid.updateRow(record, data);
                }
            }

            function customChoose() {
                var popWindow = {
                    url: "P9902CustomSel.html",
                    title: "客户选择",
                    width: 1100,
                    height: 600,
                    onload: function() {},
                    ondestroy: function(action) {}
                };
                mini.open(popWindow);
            }

            function backTypeChange(e) {
                if (e.value == "0001") {
                    $("#supplierArea").hide();
                    $("#customArea").show();
                } else {
                    $("#supplierArea").show();
                    $("#customArea").hide();
                }
            }
        </script>
</body>

</html>