<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>手动制造指令书作成</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="../boot.js" type="text/javascript"></script>
</head>

<body>
    <div class="edit-page-content">
        <div id="form1" th:object="${formdata}" class="form-horizontal" style="width: 100%; min-width: 800px;">
            <input id="id" class="mini-hidden" th:field="*{id}" />
            <input id="mode" class="mini-hidden" th:field="*{mode}" />
            <div>
                <div class="tab-content profile-edit-tab-content">
                    <div id="edit-basic" class="tab-pane in active">
                        <div style="display: false;">
                            <h4 class="header blue bolder smaller">订单信息</h4>
                            <div class="vspace-12-sm"></div>
                            <div class="space-4"></div>
                            <div class="form-group">

                                <label class="col-sm-0 control-label no-padding-right" for="form-field-username">订单号:</label>
                                <div class="col-sm-2">
                                    <input id="orderNumber" onvaluechanged="customSelected" class="mini-textbox" vtype="half:40" maxlength=40 required="true" th:field="*{customno}" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-0 control-label no-padding-right" for="form-field-username">订单日:</label>
                                <div class="col-sm-2">
                                    <input id="orderdate" class="mini-datepicker" enabled="false" required="true" />
                                </div>
                                <label class="col-sm-0 control-label no-padding-right" for="form-field-username">希望交期:</label>
                                <div class="col-sm-2">
                                    <input id="productDate" class="mini-datepicker" enabled="false" required="true" />
                                </div>
                                <label class="col-sm-0 control-label no-padding-right" for="form-field-username">回答交期:</label>
                                <div class="col-sm-2">
                                    <input id="productDate" class="mini-textbox" enabled="false" required="true" />
                                </div>

                            </div>
                            <div class="form-group">
                                <label class="col-sm-0 control-label no-padding-right" for="form-field-username">客户名称:</label>
                                <div class="col-sm-2">
                                    <input id="productDate" class="mini-textbox" enabled="false" required="true" />
                                </div>
                                <label class="col-sm-0 control-label no-padding-right" for="form-field-username">收货方:</label>
                                <div class="col-sm-2">

                                    <input name="supplierName" id="supplierName" class="mini-textbox" value="" enabled="false" vtype="maxLength:30" required="true" requiredErrorText="不能为空" onenter="onOk()" />
                                </div>
                            </div>
                        </div>

                        <h4 class="header blue bolder smaller">基本信息</h4>
                        <div class="vspace-12-sm"></div>
                        <div class="space-4"></div>
                        <div class="form-group">
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">指令书编号:</label>

                            <div class="col-sm-3">
                                <input id="prodNoType" class="mini-combobox" style="width:70px" textField="text" valueField="value" data='[{value:"01",text:"QH-J"},{value:"02",text:"QH-S"},{value:"03",text:"QH-T"}]' />
                                <input id="prodNo" class="mini-textbox" style="width:100px" vtype="half:10" maxlength=10 required="true" />
                                <input id="prodChildNo" class="mini-textbox" style="width:30px" value="-1" required="true" enabled="false" />

                            </div>

                        </div>
                        <div class="form-group">

                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">发行日:</label>
                            <div class="col-sm-2">
                                <input id="pdate" onvaluechanged="customSelected" class="mini-datepicker" vtype="half:40" required="true" th:field="*{customno}" />
                            </div>
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">发行人:</label>
                            <div class="col-sm-2">
                                <input id="contactperson" enabled="false" class="mini-textbox" maxlength=200 required="true" th:field="*{contactperson}" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">图面编号:</label>
                            <div class="col-sm-2">
                                <input id="prodectNumber" onvaluechanged="customSelected" class="mini-textbox" vtype="half:40" maxlength=40 required="true" th:field="*{customno}" />
                            </div>
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">材质:</label>
                            <div class="col-sm-2">
                                <input id="address" onvaluechanged="addressChanged" class="mini-combobox" textField="distingname" valueField="distingid" required="true" showNullItem=6 data='[{distingid:"01",distingname:"TE60"},{distingid:"02",distingname:"TE70"}]' />
                            </div>
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">品名:</label>
                            <div class="col-sm-2">
                                <input id="orderNumber" onvaluechanged="customSelected" class="mini-textbox" vtype="half:40" th:field="*{customno}" enabled="false" />
                            </div>


                        </div>
                        <div class="form-group">
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">品番:</label>
                            <div class="col-sm-2">
                                <input id="productNumber" class="mini-textbox" enabled="false" vtype="halfonly" maxlength=200 required="true" th:field="*{contactperson}" />
                            </div>

                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">品目重量:</label>
                            <div class="col-sm-2">
                                <input id="material" class="mini-textbox" vtype="halfonly" maxlength=40 required="ture" th:field="*{telephone}">
                            </div>

                        </div>
                        <div class="form-group">
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">订单数:</label>
                            <div class="col-sm-2">
                                <input id="material" class="mini-textbox" enabled="false" vtype="halfonly" maxlength=40 required="ture" th:field="*{telephone}">
                            </div>
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">安排数:</label>
                            <div class="col-sm-2">
                                <input id="material" class="mini-textbox" vtype="halfonly" maxlength=40 required="ture" th:field="*{telephone}">
                            </div>
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">必要数:</label>
                            <div class="col-sm-2">
                                <input id="material" class="mini-textbox" vtype="halfonly" maxlength=40 required="ture" th:field="*{telephone}">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-0 control-label no-padding-right" for="form-field-username">要求:</label>
                            <div class="col-sm-6">
                                <input id="consideration" style="width:87%;" class="mini-textarea" vtype="halfonly" maxlength=200 required="false" th:field="*{remark}" />
                            </div>
                        </div>
                        <div class="form-group">
                            <div style="width: 48%; float: left; margin-top: 25px;">
                                <h4 class="header blue bolder smaller">材质</h4>
                                <div class="vspace-12-sm"></div>
                                <div class="space-4"></div>
                                <div>
                                    <div class="">
                                        <div id="textureGird" class="mini-datagrid" idField="UID" showpager="false" skipReadOnlyCell="true" allowResize="false" allowCellEdit="true" allowCellSelect="true" multiSelect="true" editNextOnEnterKey="true" editNextRowCell="true">
                                            <div property="columns">
                                                <div name="drawingNo" field="drawingNo" headerAlign="center" width="100">图纸编号</div>
                                                <div field="texture" align="left" headerAlign="center" width="100">材质
                                                    <input id="address" property="editor" onvaluechanged="addressChanged" class="mini-combobox" textField="text" valueField="value" showNullItem="true" data='[{value:"01",text:"TE60"},{value:"02",text:"TE70"}]' />
                                                </div>
                                                <div field="freeCount" align="right" headerAlign="center" width="100">可用在库数
                                                </div>
                                                <div field="occupyCount" align="right" headerAlign="center" width="100">占用在库&nbsp;
                                                    <i class="ace-icon fa fa-pencil-square-o"></i>
                                                    <input id="occupyCount" property="editor" class="mini-textbox" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="width: 48%; float: right; margin-top: 25px;">
                                <h4 class="header blue bolder smaller">库存占用</h4>
                                <div class="vspace-12-sm"></div>
                                <div class="space-4"></div>
                                <div>
                                    <div class="">
                                        <div id="occupyGrid" class="mini-datagrid" showpager="false" idField="UID" allowResize="false" skipReadOnlyCell="true" allowCellEdit="true" allowCellSelect="true" multiSelect="true" editNextOnEnterKey="true" editNextRowCell="true">
                                            <div property="columns">
                                                <div name="occupyTypeName" field="occupyTypeName" headerAlign="center" width="80">占用分类</div>
                                                <div field="freeCount" align="right" headerAlign="center" width="160">可用数量</div>
                                                <div field="occupyCount" align="right" headerAlign="center" width="160">占用数量&nbsp;
                                                    <i class="ace-icon fa fa-pencil-square-o"></i> <input property="editor" class="mini-textbox" style="width:100%;" /></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div style="width: 48%; float: left; margin-top: 25px;">
                                <h4 class="header blue bolder smaller">钢柄工序</h4>
                                <div class="vspace-12-sm"></div>
                                <div class="space-4"></div>

                                <div id="datagrid1" class="mini-datagrid" showPager="false" idField="id" allowResize="false" skipReadOnlyCell="true" allowCellEdit="true" allowCellSelect="true" multiSelect="true" editNextOnEnterKey="true" editNextRowCell="true">
                                    <div property="columns">
                                        <div type="checkcolumn"></div>
                                        <input field="id" class="mini-hidden" visible="false" />
                                        <div name="LoginName" field="loginname" headerAlign="left" headerAlign="center" width="80px">工序

                                        </div>
                                        <div name="birthday" field="birthday" width="100px" headerAlign="center">开始日期&nbsp;<i class="ace-icon fa fa-pencil-square-o"></i>
                                            <input property="editor" class="mini-datepicker" style="width:100%;" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="width: 48%; float: right; margin-top: 25px;">
                                <h4 class="header blue bolder smaller">合金工序</h4>
                                <div class="vspace-12-sm"></div>
                                <div class="space-4"></div>
                                <div id="datagrid2" class="mini-datagrid" showPager="false" idField="id" allowResize="false" skipReadOnlyCell="true" allowCellEdit="true" allowCellSelect="true" multiSelect="true" editNextOnEnterKey="true" editNextRowCell="true">
                                    <div property="columns">
                                        <div type="checkcolumn"></div>
                                        <input field="id" class="mini-hidden" visible="false" />
                                        <div name="LoginName" field="loginname" headerAlign="center" width="80px">工序

                                        </div>
                                        <div name="birthday" field="birthday" headerAlign="center" width="100px">开始日期&nbsp;<i class="ace-icon fa fa-pencil-square-o"></i>
                                            <input property="editor" class="mini-datepicker" style="width:100%;" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; padding: 10px;">
                <a class="mini-button btn btn-info btn-round " onclick="onOk()" type="button">
                    <i class="ace-icon fa fa-floppy-o bigger-110"></i> 保存
                </a> &nbsp; &nbsp;

            </div>
        </div>
    </div>
    <!-- /.page-content -->
    <script type="text/javascript ">
        mini.parse();
        var datagrid = mini.get("datagrid1");
        var datagridData = new Array();
        datagridData.push({
            loginname: "WC出库",
            id: "1"
        }, {
            loginname: "保护焊",
            id: "2"
        }, {
            loginname: "钢柄处理",
            id: "3"
        }, {
            loginname: "银焊",
            id: "4"
        }, {
            loginname: "徐冷处理",
            id: "5"
        }, {
            loginname: "表面处理1",
            id: "6"
        }, {
            loginname: "检查·出货",
            id: "7"
        });

        datagrid.setData(datagridData);
        var datagrid2 = mini.get("datagrid2");
        var datagridData2 = new Array();
        datagridData2.push({
            loginname: "WC出库",
            id: "1"
        }, {
            loginname: "银片准备",
            id: "2"
        }, {
            loginname: "洗合金",
            id: "3"
        });

        datagrid2.setData(datagridData2);

        var form = new mini.Form("#form1");

        var grid = mini.get("grid1");
        var textureGird = mini.get("textureGird");
        var showAllSelect = true;
        var treeData = new Array();
        treeData.push({
            "UID": "2",
            "drawingNo": "E-3295",
            "texture": "TE60",
            "freeCount": "100",
            "occupyCount": "0",
        }, {
            "UID": "3",
            "drawingNo": "E-2575-1",
            "texture": "TE60",
            "freeCount": "100",
            "occupyCount": "0",
        }, {
            "UID": "4",
            "drawingNo": "E-3605",
            "texture": "TE60",
            "freeCount": "100",
            "occupyCount": "0"
        }, {
            "UID": "6",
            "drawingNo": "E-3589",
            "texture": "TE60",
            "freeCount": "100",
            "occupyCount": "0"
                // ,
                // "resourceurl": "<label class='function-item'><input type='radio' name='checkboxs' hideFocus/>t90</label><label class='function-item'><input type='radio' name='checkboxs' hideFocus/>t100</label>"
        })

        textureGird.setData(treeData)


        var occupyGrid = mini.get("occupyGrid");
        var showAllSelect = true;
        var treeData2 = new Array();
        treeData2.push({
            "UID": "2",
            "occupyTypeName": "库存品",
            "freeCount": "100",
            occupyCount: 0,
        }, {
            "UID": "6",
            "occupyTypeName": "在制品",
            "freeCount": "100",
            occupyCount: 0

        })

        occupyGrid.setData(treeData2)



        function ondrawcell(e) {
            var tree = e.sender,
                record = e.record,
                field = e.field,
                id = record[tree.getIdField()],
                funs = record.functions;

            if (field == 'functions') {
                e.cellHtml = createCheckboxs(funs);
            }
        }


        function addRow() {
            var newRow = {
                name: "New Row"
            };
            grid.addRow(newRow, grid.getData().length);
            grid.beginEditCell(newRow, "LoginName");
        }

        function removeRow() {
            var rows = grid.getSelecteds();
            if (rows.length > 0) {

                grid.removeRows(rows, true);
            } else {
                mini.alert("没有可删除的数据")
            }
        }

        // 页面初期化制御
        function onload(flg) {
            if (flg == 1) {
                mini.get("username ").enable();
            } else {
                mini.get("username ").disable();
            }
        }

        // 保存操作
        function onOk() {
            form.validate();
            if (form.isValid() == false) {
                businessMessage.alert("E0009 ");
                return;
            }
            businessMessage.alert("Q0002 ", null, oksave);
        }

        function oksave() {
            var data = form.getData();
            data.deliveryaddress = grid.data;
            var accessurl = " ";
            if (mini.get("mode ").value == "2 ") {
                accessurl = "/S9910Customs/add ";
            } else {
                accessurl = "/S9910Customs/update ";
            }
            doAjax(accessurl, data, function(obj) {
                if (obj.status == "SUCCESS ") {
                    businessMessage.alert("I0001 ", null, function() {
                        CloseWindow("ok ");
                    });
                } else if (obj.message == "E0024 ") {
                    businessMessage.alert(obj.text);
                    return;
                }
            });
        }
    </script>
</body>

</html>