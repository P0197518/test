<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>部門編集</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="../boot.js" type="text/javascript"></script>
</head>

<body onload="loadfocus()">

    <div class="edit-page-content">
        <div id="form1" class="form-horizontal" style="width: 100%;">
            <input id="id" class="mini-hidden" />
            <input id="mode" class="mini-hidden" />
            <div>
                <div class="tab-content profile-edit-tab-content">
                    <div id="edit-basic" class="tab-pane in active">
                        <h4 class="header blue bolder smaller">部门信息</h4>
                        <div class="vspace-12-sm"></div>

                        <div class="form-group">
                            <label id="parentidlable" class="col-sm-1 control-label no-padding-right" for="form-field-name">所属部门:</label>
                            <div class="col-sm-3">
                                <input class="mini-combobox" width="200" id="parentid" valueField="value" textField="text" ajaxType="post" emptyText="请选择..." allowInput="false" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-1 control-label no-padding-right" for="form-field-name">部门编号:</label>
                            <div class="col-sm-3">
                                <input class="mini-textbox" width="200" id="depid" vtype="maxLength:10" required="true" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-1 control-label no-padding-right" for="form-field-name">部门名称:</label>
                            <div class="col-sm-3">
                                <input class="mini-textbox" width="200" id="name" vtype="maxLength:20" required="true" />
                            </div>
                        </div>

                        <div class="space-4"></div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; padding: 10px;">
                <a class="mini-button btn btn-info btn-round " onclick="onOk()" type="button">
                    <i class="ace-icon fa fa-floppy-o bigger-110"></i> 确 定
                </a> &nbsp; &nbsp;
                <a class="mini-button btn btn-warning btn-round" onclick="onCancel()" type="button">
                    <i class="ace-icon fa fa-undo bigger-110"></i> 取　消
                </a>
            </div>
        </div>
    </div>
    <!-- /.page-content -->

    <script type="text/javascript">
        var form = new mini.Form("#form1");
        mini.parse();

        var combobox = mini.get("parentid");
        var gridData = new Array();
        gridData.push({
                "name": "経営管理部",
                "depid": "100",
                "parentid": "",
                "sortorder": "1"
            }, {
                "name": "財務",
                "depid": "101",
                "parentid": "100",
                "sortorder": "2"
            }, {
                "name": "人事/総務",
                "depid": "102",
                "parentid": "100",
                "sortorder": "3"
            },

            {
                "name": "営業本部",
                "depid": "200",
                "parentid": "",
                "sortorder": "4"
            }, {
                "name": "営業一部",
                "depid": "201",
                "parentid": "200",
                "sortorder": "5"
            }, {
                "name": "営業二部",
                "depid": "202",
                "parentid": "200",
                "sortorder": "6"
            }, {
                "name": "輸入事業部",
                "depid": "203",
                "parentid": "200",
                "sortorder": "7"
            },

            {
                "name": "产品部",
                "depid": "300",
                "parentid": "",
                "sortorder": "8"
            },

            {
                "name": "物流部",
                "depid": "400",
                "parentid": "",
                "sortorder": "9"
            }
        );
        combobox.setData(gridData);

        function SetData(data) {
            mini.get("name").setValue(data.name);
            mini.get("depid").setValue(data.depid);
            mini.get("parentid").setValue(data.parentid);
            mini.get("mode").setValue(data.mode);

            if (data.mode == "1") {
                mini.get("depid").disable();
            }

            if (data.parentid == "") {
                mini.get("parentid").disable();
            }
        }

        // 保存操作
        /*function onOk() {
			form.validate();
			if (form.isValid() == false) {
				businessMessage.alert("E0009");
				return;
			}
			businessMessage.alert("Q0002", null, oksave);
		}
		function oksave() {
			var data = form.getData();
			var accessurl  = "";
			
			if(mini.get("parentid").getValue() == mini.get("id").getValue()){
				businessMessage.alert("E0073")
                return;
            }
			
			if(mini.get("mode").value == "2"){
				accessurl = "/S9906Departments/add";
			} else{
				accessurl = "/S9906Departments/update";
			}
			doAjax(accessurl, data, function(obj) {
				if (obj.status == "SUCCESS") {
					businessMessage.alert("I0001", null, function() {
						CloseWindow("ok");
					});
				} else {
					businessMessage.alert(obj.text);
					return;
				}
			});
		}*/

        function onOk() {
            form.validate();
            if (form.isValid() == false) {
                return;
            }

            var data = {
                depid: mini.get("depid").getValue(),
                name: mini.get("name").getValue(),
                parentid: mini.get("parentid").getValue(),
                sortorder: mini.get("sortorder").getValue()
            };

            if (mini.get("mode").value == "1") {
                window.Owner.saveData(data);
            } else {
                window.Owner.addData(data);
            }

            window.CloseOwnerWindow();
        }

        // 初始化时focus
        function loadfocus() {
            mini.get("name").focus();
        }
    </script>
</body>

</html>