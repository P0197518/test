<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common/header::commonHeader(~{::head/meta},~{::head/title},~{},~{::head/script},~{})">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta charset="utf-8" />
<title>ファイルアップロード</title>

<meta name="description" content="overview &amp; stats" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<script th:src="@{/js/jquery.form.js}" type="text/javascript"></script>

</head>

<body class="no-skin" style="overflow-y: hidden; overflow-x: hidden">

	<!-- /section:basics/navbar.layout -->
	<div th:object="${formdata}" class="main-container ace-save-state" id="main-container">
		<script type="text/javascript">
			try {
				ace.settings.loadState('main-container')
			} catch (e) {
			}
		</script>

		<form th:action="@{/fileUpload/importDataMasterData}" method="post" enctype="multipart/form-data">
			<input id="importType" th:field="*{importType}" type="hidden" />
			<div>
				<div class="tab-content profile-edit-tab-content">

					<div id="edit-basic" class="tab-pane in active">

						<div class="form-group" style="height: 30px; text-align: center; margin-bottom: 20px;">
							<input name="importData" id="importData" type="file" />
						</div>
						<div class="form-group" style="height: 30px; text-align: center; margin-bottom: 20px;">
							<button class="btn btn-info btn-round" type="button" onclick="upload()">
								<i class="ace-icon glyphicon glyphicon-upload"> </i> 上传
							</button>
						</div>
					</div>
				</div>
			</div>
		</form>

		<!-- /.row -->
	</div>
</body>
<script>
	function upload() {

		if (document.getElementById("importData").value == "") {
			businessMessage.alert("E00028");
			return;
		}

		var hideForm = $('form');
		var importType = document.getElementById("importType").value;

		var options = {
			dataType : "json",
			action : "/fileUpload/importDataMasterData?importType="
					+ importType,
			beforeSubmit : function() {

			},
			success : function(result) {

				if (result.status == "ERROR") {

					businessMessage.alert(result.text, result.args);
				} else if (result.status == "CHECKERROR") {
					result.checkMessages = JSON.parse(result.text);
					showError(result);
				} else {

					var importUrl = "";

					if (importType == '1001') {
						importUrl = "/fileUpload/importMaterial";
					} else if (importType == '1006') {
						importUrl = "/fileUpload/importMaterial0003";
					} else if (importType == '1002') {
						importUrl = "/fileUpload/importMaterialTexture";
					} else if (importType == '1003') {
						importUrl = "/fileUpload/importMaterialBom";
					} else if (importType == '1004') {
						importUrl = "/fileUpload/importMaterialBomTexture";
					} else if (importType == '1005') {
						importUrl = "/fileUpload/importMaterialStock";
					} else if (importType == '1007') {
						importUrl = "/fileUpload/importOrderData";
					} else if (importType == '1008') {
						importUrl = "/fileUpload/importProductData";
					} else if (importType == '1009') {
						importUrl = "/fileUpload/importMaterialAndBomData";
					} else if (importType == '1010') {
						importUrl = "/fileUpload/importCustomMaterial";
					} else if (importType == '1011') {
						importUrl = "/fileUpload/importPurchase";
					} else if (importType == '1012') {
						importUrl = "/fileUpload/importUpdateProductNo";
					} else if (importType == '1013') {
                        importUrl = "/fileUpload/importMaterialTextureSafeCount";
                    }

					if (importUrl != '') {
						doAjax(importUrl, result.data, function(obj) {
							if (obj.status == "SUCCESS") {
								businessMessage.alert("I00001", null,
										function() {
											CloseWindow("ok");
										});
							}
						});
					}

				}

			},
			error : function(result) {
			}
		};
		hideForm.ajaxSubmit(options);
	}
</script>

</html>