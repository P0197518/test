<!DOCTYPE html>
<html>

<head th:replace="common/header::commonHeader(~{::head/meta},~{::head/title},~{},~{},~{})">
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>资源管理</title>
</head>

<body class="no-skin" onload="loadfocus()">
	<input id="resourcecd" name="resourcecd" type="hidden" value="P0713" />
	<div class="mini-toolbar">
		<table style="width: 100%;">
			<tr>
				<td style="width: 100%; height: 30px;">
					<button class="btn btn-warning btn-round autoAuth" name="add" id="add" onclick="add()" type="button">
						<i class="ace-icon fa fa-plus-circle bigger-110"> </i> 添加
					</button>
					<button class="btn btn-success btn-round autoAuth" name="edit" id="edit" onclick="edit()">
						<i class="ace-icon fa fa-pencil-square-o"> </i> 编辑
					</button>
					<button class="btn btn-danger btn-round autoAuth" name="removeItem" id="removeItem" onclick="removeItem()">
						<i class="ace-icon fa fa-times-circle"> </i> 删除
					</button>
				</td>
			</tr>
		</table>
	</div>
	<div class="mini-fit">
		<div id="grid1" th:url="@{/P0713Permission/getRoles}" class="mini-datagrid" 
		headerAlign="center" idField="id" allowResize="false" allowCellSelect="true" 
		multiSelect="false" editNextOnEnterKey="true" style="width: 100%; height: 100%;" 
		sortField="" sortOrder="">
			<div property="columns">
				<div type="checkcolumn">选择</div>
				<div field="roleName" name="roleName" width="80" headerAlign="center">角色名</div>
				<div field="introduction" name="introduction" width="320" headerAlign="center">备注</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		mini.parse();
		var grid = mini.get("grid1");

		function search() {

			var searchcondation = {};

			grid.load(getPagerInfo("grid1", searchcondation));
		}

		search();

		// 添加操作
		function add() {
			var popupParam = openCommonPopupParam("/P0713Permission/indexEdit",
					"权限新增");
			popupParam.ondestroy = function(action) {
				if (action == "ok") {
					grid.reload();
				}
			};
			mini.open(popupParam);
		}

		// 编辑操作
		function edit() {
			var rows = grid.getSelecteds();
			if (rows.length == 1) {
				var row = grid.getSelected();

				var popupParam = openCommonPopupParam(
						"/P0713Permission/indexEdit?id=" + row.id,
						"权限编辑");
				popupParam.ondestroy = function(action) {
					if (action == "ok") {
						grid.reload();
					}
				};
				mini.open(popupParam);
			} else {
				mini.alert(businessMessage.get("E00002"));
			}

		}

		// 删除操作
		function removeItem() {
			var rows = grid.getSelecteds();
			if (rows.length > 0) {
				businessMessage.alert("Q00001", null, function() {
					doAjax("/P0713Permission/deleteRoles", rows[0], function(obj) {
						if (obj.status == "SUCCESS") {
							businessMessage.alert("IC0002");
							grid.reload();
						}
					});
				});
			} else {
				businessMessage.aert("E00002")
			}
		}

		function reuseRoles() {
			var rows = grid.getSelecteds();
			if (rows.length > 0) {
				businessMessage.alert("Q00003", null, function() {
					doAjax("/P0713Permission/reuseRoles", rows[0], function(obj) {
						if (obj.status == "SUCCESS") {
							businessMessage.alert("I00003");
							grid.reload();
						}
					});
				});
			} else {
				businessMessage.aert("E00002")
			}
		}

		// 焦点设置
		function loadfocus() {

		}
	</script>
</body>

</html>