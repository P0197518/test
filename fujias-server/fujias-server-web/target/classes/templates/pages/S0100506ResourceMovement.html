<!DOCTYPE html PUBLIC "-//W3C//Dtd XHTML 1.0 transitional//EN" "http://www.w3.org/tr/xhtml1/Dtd/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head th:replace="common/header::commonHeader(~{},~{::head/title},~{},~{},~{})">
<title>権限管理</title>
</head>

<body>
	<div id="searchCondation">
		<input class="mini-hidden" width="200" id="id" th:field="${formdata.id}" />
	</div>
	<div class="edit-page-content">
		<div id="editForm1" th:object="${formdata}" class="form-horizontal" style="width: 100%; min-width: 800px;">
			<input name="type" id="type" class="mini-hidden" /> <input name="parentId" id="parentId" class="mini-hidden" />
			<div>
				<div class="tab-content profile-edit-tab-content">
					<div id="edit-basic" class="tab-pane in active">
						<h4 class="header blue bolder smaller">资源信息</h4>

						<div class="vspace-12-sm"></div>

						<div class="form-group">
							<label class="col-xs-2 control-label no-padding-right" for="form-field-username">资源名称:</label>

							<div class="col-xs-3">
								<input name="resourceName" id="resourceName" class="mini-textbox" value="" vtype="maxLength:30" required="true" requiredErrorText="不能为空" />
							</div>

							<label class="col-xs-2 control-label no-padding-right" for="form-field-username">排序：</label>

							<div class="col-xs-3">
								<input name="sortOrder" id="sortOrder" class="mini-textbox" vtype="maxLength:20; int" value="" required="true" requiredErrorText="不能为空" />
							</div>
						</div>

						<div class="space-4"></div>

						<div class="form-group">
							<label class="col-xs-2 control-label no-padding-right" for="form-field-username">资源路径:</label>

							<div class="col-xs-3">
								<input name="resourceUrl" id="resourceUrl" class="mini-textbox" vtype="maxLength:50" value="" required="false" requiredErrorText="不能为空" />
							</div>

							<label class="col-xs-2 control-label no-padding-right" for="form-field-username">资源编号:</label>

							<div class="col-xs-3">
								<input name="resourceCd" id="resourceCd" class="mini-textbox" vtype="maxLength:30" value="" />
							</div>
						</div>

						<div class="space-4"></div>

						<div class="form-group">
							<label class="col-xs-2 control-label no-padding-right" for="form-field-username">按钮ID:</label>

							<div class="col-xs-3">
								<input name="elementId" id="elementId" class="mini-textbox" vtype="maxLength:30" value="" />
							</div>
						</div>

						<div class="space-4"></div>
					</div>
				</div>
			</div>

			<div style="text-align: center; padding: 10px;">
				<a class="mini-button btn btn-info btn-round " onclick="save()" type="button"> <i class="ace-icon fa fa-floppy-o bigger-110"></i> 确 定
				</a> &nbsp; &nbsp; <a class="mini-button btn btn-warning btn-round" onclick="cancelRow()" type="button"> <i class="ace-icon fa fa-undo bigger-110"></i> 取 消
				</a> &nbsp; &nbsp; <a class="mini-button btn btn-warning btn-round" onclick="onCancel()" type="button"> <i class="ace-icon fa fa-undo bigger-110"></i> 关 闭
				</a>
			</div>
		</div>
	</div>
	<!-- /.page-content -->

	<div class="mini-fit">
		<div id="datagrid1" th:url="@{/S0100505Resources/getAction}" class="mini-datagrid" style="width: 100%; height: 100%;" showPager="false">

			<div property="columns">
				<div type="checkcolumn">选择</div>
				<div type="indexcolumn" headerAlign="center">No</div>
				<div name="resourceName" field="resourceName" headerAlign="center" align="center" width="100">资源名称</div>
				<div field="resourceUrl" headerAlign="center" align="center" width="150">资源路径</div>
				<div field="sortOrder" headerAlign="center" align="center" width="80">排序</div>
				<div field="elementId" headerAlign="center" align="center" width="80">按钮ID</div>
				<div field="cz" headerAlign="center" align="center" renderer="onActionRenderer" width="80">操作</div>
			</div>
		</div>


	</div>

	<script type="text/javascript">
        mini.parse();
        var form = new mini.Form("editForm1");
        var grid = mini.get("datagrid1");
        
        function gridLoad() {
            var searchcondation = getJsonObject("searchCondation");
            grid.load(getPagerInfo("datagrid1", searchcondation));
        }
        gridLoad();
        
        // 删除按钮
        function onActionRenderer(e) {
            var s = '<a class="Delete_Button" href="javascript:delRow()">削除</a>';

            return s;
        }

        //删除权限
        function delRow() {
            var rows = grid.getSelecteds();
            if (rows.length > 0) {
                businessMessage.alert("Q00001", null, function() {
                    doAjax("/S0100505Resources/delete", rows[0], function(obj) {
                        if (obj.status == "SUCCESS") {
                            businessMessage.alert(obj.text);
                            gridLoad();
                        }
                    });
                });
            } else {
                businessMessage.alert("E00002");
            }
        }
        
        //添加权限
        function save() {
        	form.validate();
        	if (form.isValid() == false) {
                businessMessage.alert("E00006");
                return;
            }
        	var data = form.getData();
        	data.type = "3";
        	data.parentId = mini.get("id").getValue();
            doAjax("/S0100505Resources/add", data, function(obj) {
                if (obj.status == "SUCCESS") {
                	gridLoad();
                	form.clear();
                }
            });
        }
        
        function cancelRow() {
            form.clear();
        }
    </script>
</body>

</html>